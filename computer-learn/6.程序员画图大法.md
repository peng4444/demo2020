# 程序员画图大法

### UML
[UML教程](https://www.cnblogs.com/jingmoxukong/p/10445894.html)
```markdown
UML即统一建模语言，是一种用于说明、可视化、构建和编写面向对象、软件密集型系统的开放方法。UML对大规模、复杂系统的建模有极大的帮助。
UML通过它的元模型和表示法，把通过文字和其他表达方法难以表达清楚的内容，简单直观的通过图形表达出来。
UML 图形主要分为结构型图形，行为型图形两大类。
    结构型图:静态图（类图、对象图、包图），实现图（部署图、组件图），剖面图，复合结构图
    行为型图:用例图、状态机图、活动图、交互图形（通信图、交互概述图、时序图、时间图）
```
![image-20201129161922092](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129161922.png)
### 1.基本流程图
#### 1.1.基本流程图介绍
```markdown
1.什么是流程图？
    流程图（Flow Chart）是表示算法、工作流或流程的一种框图表示，它以不同类型的框表示不同种类的步骤，两个步骤之间通过箭头连接。
    流程图是表示算法和计算机程序的工具，但现在已经被应用到各种流程中。
2.为什么要使用流程图？
    流程图在信息展示中扮演着重要角色，它能够帮助我们将复杂的问题可视化，可以清楚地描述问题或任务的结构。
    流程图便于说明解决已知问题的方法，在分析、设计、记录及操控等很多领域的流程或程序中都有广泛应用。
    在实际开发中，流程图是程序员设计技术方案，开发人员之间交流设计思想的一个主要图形之一。
    同时流程图也是我们开发人员和产品、测试沟通的一个工具，他们可能看不懂你的代码，但是看得懂流程图。
3.何时使用流程图？
    那么使用流程图的典型场景有哪些？
    - 当需要描述复杂流程时；
    - 当分析一些不必要的步骤时；
    - 当我们需要帮助团队成员理解程序时；
    - 当我们需要设计一个新的流程时。
4.核心符号
    终端符号，表示流程的开始和结束：椭圆
    流程，表示某个特殊的操作。长方形
    文档，表示一个输入或输出的介质，如输入或输出。
    决策，表示一个决策或分支点。采用菱形表示，表示此时分为多个情况，每种情况可表示一种子任务，通常有两种情况：是，否。
    数据，表示信息进入或离开处理程序。输入可能是一个外卖订单，输出可能是一个外卖包裹。
    延时或瓶颈，表示程序的延时或者性能瓶颈。
    流，表示流程处理的方向。
    汇总，表示多个流程汇总到一处。通常用在多个流指向同一个处理流程，为了美观，可以先指向该组件再从该组件指向该处理流程。
    或，表示多个流程之间是或关系。
    数据库，表示文档和档案的存储。
    页面内引用，表示上一个或下一个步骤在此绘图的其他位置，需设置一串字符串来标识，多用于大型流程图。
    页面外引用，表示将使用单独的页面绘制子流程图，需设置一串字符串来标识，多用于大型流程图。
```
#### 1.2.基本流程图举例
```markdown
比如产品让我们设计一个登录的功能，场景描述如下：
    系统有两种登录方式，一种是通过手机号和短信验证码登录；一种是通过用户名密码登录。
    如果是手机和短信验证码登录方式，用户点击获取验证码按钮，手机会收到验证码短信（60 秒内只能获取一次，验证码 5 分钟内有效），
    输入正确登录成功，输入错误提示失败。如果采用用户名密码登录，用户名和密码正确则登录成功，否则登录失败。
根据以上描述，我们可以作出下面的参考流程图：
```
![image-20201129161232932](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129161240.png)
### 2.用例图
#### 2.1.用例图介绍
```markdown
用例图是一种以用户视角来描述系统功能的图形。
用例图包括：系统（System）、用例（UseCase）、参与者（Actor）以及用例和参与者之间的关系。
    其中被描述的事物就是系统；系统的参与者称为角色；角色在系统中要的做的事就是用例也叫行为。
用例图通常用在需求分析和总体设计阶段。用例图的目的 是让项目的参与者能够在更高层次上理解系统。
通过用例图可以基于用户视角对大型项目的功能进行拆分，而 任务分解又是降低复杂度的核心方法之一。
基本组件：参与者使用小人图标表示，系统通过方形表示，用例一般采用椭圆形表示，参与者和用例之间通过连线来表示关系。
参与者和参与者之间可能是并列的关系也可能是泛化关系，即面向对象语言中的继承关系。一般用户、管理员、超级管理员之间可以有继承关系。
用例和用例之间主要有 3 种关系，一种是包含关系（include）, 一种是拓展关系（extend），还有一种是继承关系。
```
#### 2.2.用例图举例
```markdown
某产品给出了一个需求描述：
    我们要设计一个新闻系统，这个系统为了满足 xxxx 的需求，在这个系统中普通用户可以登录，读新闻；管理员除了具备一般用户的功能外，
        还可以写新闻、审核新闻，发布新闻；高级管理员具有以上所有功能外，还可以删除新闻。
    普通用户不仅可以读新闻，将新闻内内容打印并可以支持分享到朋友圈，满足用户的个性化需求，增强用户的体验，提高互动度等。
    管理员在审核新闻和发布新闻之前要可以预览新闻，避免审核和发布失误。
    高级管理员在删除新闻之前要有弹窗提醒。
从上面的描述我们可知系统就是某新闻系统；参与者就有三类：普通用户、普通管理员、超级管理员；
    核心用例有登录、读新闻、写新闻、审核新闻、发布新闻、删除新闻等。
根据以上的分析，我们可以大致画图如下：
```
![image-20201129162324771](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129162324.png)
### 3.类图
#### 3.1.类图简介
```markdown
类图是软件工程的统一建模语言中的一种静态结构图，该图描述系统的类和其它类和属性之间的关系。
类图描述了面向对象系统中的类的结构，以及类之间的关系，类图中也会体现出约束，也会展示出类的属性。
类图中，类主要由三部分构成：类名部分、属性部分和操作部分，这三个部分通过横线隔开。
就类图而言，关系主要指类之间的联系，主要包括依赖关系、关联关系、聚合关系、组合关系和泛化关系。
    依赖关系是五种关系中耦合最小的一种关系，类A要完成某种功能引用了类B，那么A就依赖了B，如类A的成员函数的返回值、参数、局部变量或静态方法调用使用了B。
        依赖关系的生命周期较短，一般在方法调用期间存在。
    关联主要分为两类：单向关联和双向关联。关联关系的生命周期更长，随着类的初始化而产生，随着对象的销毁而结束。
        单向关联，用带箭头的实线表示。关联关系表示类比较强的依赖，且这种关系由一方来维护，如学生依赖老师，学生类中有一个老师的成员属性。
        双向关联如下图所示，通过实线连接，表示两个类相互引用。
    聚合关系使用实心线加空心菱形表示。聚合用来表示集体和个体的关系，是一种"has-a"的关系。例如班级和学生之间，公司和员工之间就存在聚合关系。
    组合关系是关联关系的一种特例，表示一个整体和其组成部分的关系，是一种"contains-a"关系。如人作为一个整体，包括头部、腹部、腿部等组成。
    泛化关系 主要指类与类之间的继承关系以及类与接口之间的实现关系。以Integer为例，实现了Comparable接口，继承了Number类，
        而Number类又实现了Serializable接口，可用如下类图表示。实现接口通过待箭头的虚线表示，而继承类则通过带箭头的实现表示。
IDEA可以选择某个类，右键–> Diagrams --> Show Diagram --> Java Class Diagrams 来自动根据源码绘制类图。
```
#### 3.2.类图举例
```markdown
假如有这样一个场景：
    一个交易系统中主要包括顾客、订单、订单详情、商品、支付等核心类。其中顾客的属性包括顾客的姓名、收货地址、联系方式和是否活跃。
订单的主要属性包括订单的创建日期，订单详情、订单的状态、支付方式。订单的支付方式可以有多种，如信用卡、现金、支票、转账。
订单的状态包括创建状态、海运中、投递完成和支付完成这几个状态。订单详情包括商品数量，税信息，订单详情类还要提供计算总金额和重量的功能。
订单详情中包含商品，商品有重量和描述信息，商品对象中要提供获取商品重量的接口，还要提供根据重量获取价格的功能。
根据上述描述可以绘制出核心的类、属性和行为，然后再去梳理类之间的关系。
    类之间的关系需要通过需求或者常识得出。一个顾客可能未下单，即有零个订单，也可能多次下单从而产生多个订单。
一个订单只有一种状态，因此订单和状态之间是一对一的关系。由于支持多种支付方式，因此订单和支付方式之间是一对多的关系。
支付方式可以是一个抽象类，每种具体的支付方式是其实现类，因此它们之间是泛化关系。订单必然订单项，最少为一个。
而一个商品有可能被一次或多次下单而成为订单项，也可能没有被下单过，因此一个商品可能对应零个或者多个订单订单项。
根据这个场景描述和分析就可以绘制出如下：
```
![image-20201129163104477](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129163104.png)
### 4.时序图
#### 4.1.时序图简介
```markdown
时序图又称顺序图，属于UML行为图， 时序图主要用来表示对象之间的交互顺序。
    时序图反映了一系列对象的交互与协作关系，清晰立体地反映系统的调用纵深链路。
    时序图的核心元素包括：对象（Actor）、生命线（Lifeline）、控制焦点（Focus of control）、消息（Message）等。
    生命线，是一条垂直的虚线，用来表示交互的独立个体，表示序列图中的对象在一段时间内的存在。
    参与者，可以指人，外部其他系统，还可以指子系统。
    控制焦点，表示对象执行一项操作的时期，是时序图中表示时间段的符号，用覆盖在生命线长矩形表示，矩形的顶部和箭头对齐，分别表示开始和结束时间，因此矩形的长度也表示持续的时间。
    消息（Message）是对象之间的一种通信机制。通常为了提高可读性，时序图的第一个消息总是从顶端开始，一般位于图的左上角。
时序图使用场景分为三类：业务模型时序图、概念模型时序图和设计模型时序图。
    业务模型时序图用于为领域模型中的业务实体交互建模，目标是实现业务用例。
    概念模型时序图依据业务模型场景采用分析类来重新绘制一遍，目标同样是实现业务用例。因为分析类本身代表了系统原型，所以这时的时序图已经有了实现的影子。
    设计模型时序图使用设计类作为对象绘制，目标是实现概念模型中的某个事件流，一般以一个完整交互为单位，消息细致到方法级别。
因为设计模型时序图工作量实在太大，不需要为每一个交互都绘制时序图，但一定要有足够的概念模型时序图来支撑需求与实现之间的过渡。
```
#### 4.2.时序图举例
```markdown
文字描述：发表朋友圈时可以选择文本或图片，如果只有文本不需要风控信息，如果发图片则需要检查风控信息。
点评状态最初为初始化状态，查询风控信息后更新为通过或者风控状态。由于方案设计的不合理，在初始状态时存储一份，如果是文本则直接通过，如果是图片则查询风控信息后再存储一次。
而且为了查询性能，支持复杂的数据结构，支持超长度文本类型，支持丰富的查询需求，发送朋友圈状态数据存储到本地数据库后，还要异步通知存储服务，存储服务反查该朋友圈动态的信息存储一份 。
由于两次保存间隔极短，而通知存储服务反查是异步的，两次消息的顺序性没法保证，而且即使消息顺序抵达，未必先抵达的消息可以先处理，优先存储到 Elstic中，所以可能存在Elstic旧值覆盖新值的情况，出现BUG。
为了更清楚地描述该 BUG ，我们画出对应的时序图：
```
![image-20201129163854858](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129163854.png)
### 5.状态机图
#### 5.1.状态机图简介
```markdown
状态机图也叫状态图、状态转换图、简单状态图，它描述一个事物随着事件的状态变化。
    简而言之，状态机图主要描述对象的状态以及引起对象状态变换的事件。
    状态机图可以对对象、用例甚至整个系统的行为建模。
在分析和设计时，可以建模事件驱动对象；我们还可以使用多个状态机图来表现同一个状态机和行为的不同方面。
核心组件:
    状态表示一个对象生命周期中的一种条件，它可以满足执行某些活动的条件后者等待接收某些事件。
    转换是指前一个状态到后一个状态经历的事件。转换前的状态称为源状态，转变后的状态称为目标状态。
    ....
```
#### 5.2.状态机图举例
```markdown
人的一生从婚姻角度看，包括单身、已婚、离异三个大状态；从职场角度看主要包括待业、受雇、退休三个大状态，当然从其他角度还可以画出更详细的状态图。
```
![image-20201129164332091](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129164332.png)
```markdown
另外以某个博客评论审核系统为例，演示状态图的画法。
    某博客系统发表评论后需要审核，审核通过后读者才可见，审核不通过则需要重新修改，修改通过才能读者可见。
    我们先寻找主要状态：待审核、待修改、公开，然后根据实际情况填充状态之间的转换。
```
![image-20201129164355299](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129164355.png)
### 6.活动图
#### 6.1.活动图简介
```markdown
活动图是工作流的图形表示，活动图主要由活动和动作构成，可以支持分支选择、迭代、并行。
在UML中，活动图主要用于为计算性和组织性过程（即工作流）建模，相关活动之间的数据流也在其覆盖范围。
活动图显示连接动作和其他节点（如决策、分支、连接、合并和对象节点）的流。一般情况下活动和活动图之间是一一对应关系。
 活动图和状态图关系
    活动图简化了流程图并添加了一些新的符号。
    状态图着重描述从一个状态到另一个状态的流程，主要有外部事件的参与。
    活动图将流程分为一个一个活动，通过活动的先后顺序来展示流程；而状态机图从某个事物的状态是如何变化的角度来描述流程。
核心组件:
    活动发生前的状态称之为开始状态。除非有嵌套活动，否则一个流程只能有一个开始状态。
    最终节点采用大圆套小圆表示，其中内部的小圆为实心。活动图只能有一个初始状态，但是可以有 0 个或多个最终状态。
    状态流转包括控制流转和对象流转。
    决策节点承接一个流程控制来源，将其拆分为多个流程控制出口。合并节点将多个可选分支汇聚到一个节点中。
```
#### 6.2.活动图举例
```markdown
场景描述：读者在某博客系统阅读文章后可以发表评论，但是评论需要作者审核，审核通过后对其他读者才可见，审核不通过则需要重新修改。
由于这里有两个角色，读者和作者，因此我们采用泳道的方式绘图。
评论审核是否通过需要走不通的流程，因此需要使用分支进行活动的流程控制。
根据场景描述以及上述分析，我们绘图如下：
```
![image-20201129164801602](https://raw.githubusercontent.com/peng4444/picgo/main/img/20201129164801.png)
### 